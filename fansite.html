<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã€éå…¬å¼ã€‘ãƒ‰ã‚ºãƒ«ç¤¾ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</title>

<style>
body {
  margin: 0;
  font-family: "Arial", sans-serif;
  background: linear-gradient(135deg, #ffefba, #ffffff);
  color: #333;
}

header {
  background: #ffcc00;
  padding: 20px;
  text-align: center;
  font-size: 28px;
  font-weight: bold;
}

nav {
  display: flex;
  justify-content: center;
  background: #ff9900;
}

nav button {
  background: none;
  border: none;
  padding: 15px 25px;
  font-size: 16px;
  cursor: pointer;
  color: white;
  font-weight: bold;
}

nav button:hover {
  background: #ff6600;
}

.section {
  display: none;
  padding: 30px;
}

.active {
  display: block;
}

.card {
  background: white;
  padding: 20px;
  margin: 15px 0;
  border-radius: 15px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.countdown {
  font-size: 24px;
  color: #ff3366;
  font-weight: bold;
}

@media (max-width: 600px) {
  nav { flex-direction: column; }
}
</style>
</head>

<body>

<header>
ã€éå…¬å¼ã€‘ãƒ‰ã‚ºãƒ«ç¤¾ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
<p style="font-size:16px; color:#d10000; margin-top:5px;">
ğŸš§ ç¾åœ¨ã‚µã‚¤ãƒˆåˆ¶ä½œä¸­ ğŸš§
</p>
</header>

<nav>
<button onclick="showSection('home')">ğŸ  ãƒ›ãƒ¼ãƒ </button>
<button onclick="showSection('event')">ğŸ“… ã‚¤ãƒ™ãƒ³ãƒˆ</button>
<button onclick="showSection('goods')">ğŸ›ï¸ ã‚°ãƒƒã‚º</button>
<button onclick="showSection('member')">ğŸ‘¥ ãƒ¡ãƒ³ãƒãƒ¼</button>
</nav>

<div id="home" class="section active">
<h2>æœ€æ–°ã‚¤ãƒ™ãƒ³ãƒˆ</h2>
<div id="latestEvent" class="card"></div>
<div class="countdown" id="countdown"></div>
</div>

<div id="event" class="section">
<h2>ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§</h2>
<div id="eventList"></div>
</div>

<div id="goods" class="section">
<h2>ã‚°ãƒƒã‚ºæƒ…å ±</h2>
<div id="goodsList"></div>
</div>

<div id="member" class="section">
<h2>ãƒ¡ãƒ³ãƒãƒ¼ç´¹ä»‹</h2>
<div class="card"><h3>ãƒ‰ã‚ºãƒ«</h3><p>ãƒªãƒ¼ãƒ€ãƒ¼ã€‚æ˜ã‚‹ãå…ƒæ°—ãªå®Ÿæ³ï¼</p></div>
<div class="card"><h3>ã¼ã‚“ã˜ã‚…ã†ã‚‹</h3><p>å„ªã—ã„é›°å›²æ°—ã¨å®‰å®šæ„Ÿã€‚</p></div>
<div class="card"><h3>ãŠã‚“ã‚Šãƒ¼</h3><p>é«˜ã„ã‚²ãƒ¼ãƒ ã‚¹ã‚­ãƒ«ï¼</p></div>
<div class="card"><h3>ãŠã‚‰ãµãã‚“</h3><p>ç‹¬ç‰¹ãªä¸–ç•Œè¦³ã€‚</p></div>
<div class="card"><h3>ãŠãŠã¯ã‚‰MEN</h3><p>ãƒ ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼ã€‚</p></div>
</div>

<script>
function showSection(id){
document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
document.getElementById(id).classList.add('active');
}

const eventsURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQeScX6j_3nRvOlYuVa0P4wGG6piBpQ2ZwXzZxEPscII79uBByy9Z8_MDND2wouDZboQQon7XVVN4Gp/pub?gid=0&single=true&output=csv";
const goodsURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQeScX6j_3nRvOlYuVa0P4wGG6piBpQ2ZwXzZxEPscII79uBByy9Z8_MDND2wouDZboQQon7XVVN4Gp/pub?gid=1794976478&single=true&output=csv";
const videosURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQeScX6j_3nRvOlYuVa0P4wGG6piBpQ2ZwXzZxEPscII79uBByy9Z8_MDND2wouDZboQQon7XVVN4Gp/pub?gid=594878538&single=true&output=csv";
const wordsURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQeScX6j_3nRvOlYuVa0P4wGG6piBpQ2ZwXzZxEPscII79uBByy9Z8_MDND2wouDZboQQon7XVVN4Gp/pub?gid=1791332374&single=true&output=csv";

// CSVãƒ‘ãƒ¼ã‚¹
function parseCSV(text){
const rows = text.trim().split("\n");
const headers = rows.shift().split(",");
return rows.map(row=>{
const values = row.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g);
return headers.reduce((obj, header, i)=>{
obj[header.trim()] = values ? values[i]?.replace(/^"|"$/g,"") : "";
return obj;
},{});
});
}

// ======================
// ğŸŒŸ ä»Šæ—¥ã®ãƒ‰ã‚ºãƒ«ç¤¾
// ======================

function loadTodayContent(){
const category = Math.random() < 0.5 ? "video" : "word";

if(category === "video"){
fetch(videosURL)
.then(res=>res.text())
.then(text=>{
const data = parseCSV(text);
if(data.length === 0) return;
const random = data[Math.floor(Math.random()*data.length)];

document.getElementById("todayBox").innerHTML = `
<h3>ğŸŒŸ ä»Šæ—¥ã®ãƒ‰ã‚ºãƒ«ç¤¾ã€å‹•ç”»ã€‘</h3>
<p><strong>${random.title}</strong></p>
<p><a href="${random.url}" target="_blank">â–¶ å‹•ç”»ã‚’è¦‹ã‚‹</a></p>
`;
});
}else{
fetch(wordsURL)
.then(res=>res.text())
.then(text=>{
const data = parseCSV(text);
if(data.length === 0) return;
const random = data[Math.floor(Math.random()*data.length)];

document.getElementById("todayBox").innerHTML = `
<h3>ğŸŒŸ ä»Šæ—¥ã®ãƒ‰ã‚ºãƒ«ç¤¾ã€ç”¨èªã€‘</h3>
<p><strong>${random.word}</strong></p>
<p>${random.description}</p>
`;
});
}
}

// ======================
// ğŸ“… ã‚¤ãƒ™ãƒ³ãƒˆ + å‚åŠ äºˆå®š
// ======================

let myEvents = JSON.parse(localStorage.getItem("myEvents") || "[]");

function saveMyEvents(){
localStorage.setItem("myEvents", JSON.stringify(myEvents));
renderMyEvents();
}

function toggleEvent(title){
if(myEvents.includes(title)){
myEvents = myEvents.filter(e=>e!==title);
}else{
myEvents.push(title);
}
saveMyEvents();
}

function renderMyEvents(){
const box = document.getElementById("myEvents");
if(!box) return;
if(myEvents.length===0){
box.innerHTML = "<p>ã¾ã å‚åŠ äºˆå®šã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>";
return;
}
box.innerHTML = myEvents.map(e=>`<div class="card">${e}</div>`).join("");
}

// ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—
fetch(eventsURL)
.then(res=>res.text())
.then(text=>{
const data = parseCSV(text);

let nearestEvent=null;
let nearestTime=Infinity;

data.forEach(event=>{
const eventTime = new Date(event.date).getTime();

const isJoined = myEvents.includes(event.title);
const btnText = isJoined ? "å‚åŠ äºˆå®šâœ”" : "å‚åŠ äºˆå®šã«ã™ã‚‹";

const card = `
<div class="card">
<h3>${event.title}</h3>
<p>ğŸ“… ${event.date}</p>
<p>ğŸ“ ${event.location}</p>
<p>${event.note}</p>
<button onclick="toggleEvent('${event.title}')">${btnText}</button>
</div>`;

document.getElementById("eventList").innerHTML += card;

if(eventTime > Date.now() && eventTime < nearestTime){
nearestTime = eventTime;
nearestEvent = event;
}
});

if(nearestEvent){
document.getElementById("latestEvent").innerHTML = `
<h3>${nearestEvent.title}</h3>
<p>ğŸ“… ${nearestEvent.date}</p>
<p>ğŸ“ ${nearestEvent.location}</p>
<p>${nearestEvent.note}</p>
`;
startCountdown(nearestTime);
}

renderMyEvents();
});

// ======================
// ğŸ› ã‚°ãƒƒã‚º
// ======================

fetch(goodsURL)
.then(res=>res.text())
.then(text=>{
const data = parseCSV(text);
data.forEach(item=>{
const card = `
<div class="card">
<h3>${item.name}</h3>
<p>ğŸ’° ${item.price}å††</p>
<p>${item.description}</p>
</div>`;
document.getElementById("goodsList").innerHTML += card;
});
});

<div id="todayBox" class="card"></div>
<h3>ğŸŸ ã‚ãªãŸã®å‚åŠ äºˆå®šã‚¤ãƒ™ãƒ³ãƒˆ</h3>
<div id="myEvents"></div>

// ======================
// â³ ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³
// ======================

function startCountdown(time){
setInterval(()=>{
const diff = time - Date.now();
if(diff<=0){
document.getElementById("countdown").innerHTML="ğŸ‰ æœ¬æ—¥é–‹å‚¬ï¼";
return;
}
const d=Math.floor(diff/86400000);
const h=Math.floor((diff%86400000)/3600000);
const m=Math.floor((diff%3600000)/60000);
const s=Math.floor((diff%60000)/1000);
document.getElementById("countdown").innerHTML=
`é–‹å‚¬ã¾ã§ ${d}æ—¥ ${h}æ™‚é–“ ${m}åˆ† ${s}ç§’`;
},1000);
}

// èµ·å‹•
loadTodayContent();
</script>

<footer style="background:#ffcc00; padding:20px; text-align:center; font-size:14px; margin-top:40px;">
<p>
ã“ã¡ã‚‰ã®ã‚µã‚¤ãƒˆã¯éå…¬å¼ãƒ•ã‚¡ãƒ³ã‚µã‚¤ãƒˆã§ã™ã€‚<br>
ã‚¤ãƒ™ãƒ³ãƒˆãƒ»ã‚°ãƒƒã‚ºæƒ…å ±ã¯æ‰‹å‹•ã§è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚<br>
æœ€æ–°ãƒ»è©³ç´°æƒ…å ±ã¯ãƒ‰ã‚ºãƒ«ç¤¾å…¬å¼ã‚µã‚¤ãƒˆã‚’ã”è¦§ãã ã•ã„ã€‚
</p>

<p>
æ²è¼‰ã—ã¦ã„ã‚‹åç§°ãƒ»ç”»åƒç­‰ã®æ¨©åˆ©ã¯å„æ¨©åˆ©è€…æ§˜ã«å¸°å±ã—ã¾ã™ã€‚<br>
å•é¡ŒãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤ç­‰å¯¾å¿œã„ãŸã—ã¾ã™ã€‚
</p>
</footer>
</body>

</html>

